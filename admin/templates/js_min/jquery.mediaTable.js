(function(a){var g=function(f,g){var d=a(this),b=d.data("MediaTable");if(!a.isEmptyObject(b))return;b={$wrap:a("<div>"),$table:d,$menu:false,cfg:f,id:d.attr("id")};if(!b.id){b.id="MediaTable-"+g;b.$table.attr("id",b.id)}b.$table.addClass("activeMediaTable");b.$wrap.addClass("mediaTableWrapper");b.$table.before(b.$wrap).appendTo(b.$wrap);b.cfg.menu&&c(b);b.$table.find("thead th").each(function(a){e.call(this,a,b)});b.$table.data("MediaTable",b)},c=function(b){b.$menu=a('<div class="btn-group" />');b.$menu.$header=a('<a class="btn btn-small dropdown-toggle" data-toggle="dropdown" href="#" />');b.$menu.$list=a('<ul class="dropdown-menu" />');b.$menu.addClass("mediaTableMenu").addClass("mediaTableMenuClosed").append(b.$menu.$header).append(b.$menu.$list);b.$wrap.addClass("mediaTableWrapperWithMenu");b.$menu.$header.html(b.cfg.menuTitle+' <span class="caret"></span>');b.$table.before(b.$menu);a(window).bind("orientationchange resize",function(){b.$menu.find("input").trigger("updateCheck")});b.$menu.$header.bind("click",function(){b.$menu.toggleClass("mediaTableMenuClosed")});b.$menu.$list.bind("mouseleave",function(){b.$menu.toggleClass("mediaTableMenuClosed")})},e=function(g,c){var d=a(this),e=d.attr("id"),i=d.attr("class");if(!e){e=c.id+"-mediaTableCol-"+g;d.attr("id",e)}if(c.cfg.menu&&!d.is(".persist")){var h=a('<li><label for="toggle-col-'+c.id+"-"+g+'" class="checkbox"><input type="checkbox" name="toggle-cols" id="toggle-col-'+c.id+"-"+g+'" value="'+e+'" /> '+d.text()+"</label></li>");c.$menu.$list.append(h);b(d,h.find("input"),c)}a("tbody tr",c.$table).each(function(){f.call(this,g,e,i)})},f=function(e,d,b){var c=a(this).find("td,th").eq(e);c.attr("headers",d);b&&c.attr("class",b)},b=function(d,a,e){var c=function(){var c=a.val(),b=e.$table.find("#"+c+", [headers="+c+"]");if(a.is(":checked"))b.show();else b.hide()},b=function(){if(d.is(":visible"))a.attr("checked",true);else a.attr("checked",false)};a.bind("change",c).bind("updateCheck",b).trigger("updateCheck")},d=function(){var b=a(this).data("MediaTable");if(!b)return;b.$wrap.after(b.$table).remove();b.$table.removeClass("activeMediaTable");b.$table.data("MediaTable",null)};a.fn.mediaTable=function(){var b=false;if(!arguments.length||a.isPlainObject(arguments[0]))b=a.extend({},{menu:true,menuTitle:"Columns",t:"e"},arguments[0]);if(b!==false)a(this).each(function(a){g.call(this,b,a)});else if(arguments.length)switch(arguments[0]){case"destroy":a(this).each(function(){d.call(this)})}return this}})(jQuery)