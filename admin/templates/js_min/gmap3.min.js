(function(d){function x(){var a=[];this.empty=function(){for(var b=0;b<a.length;b++)if(a[b])return false;return true};this.add=function(b){a.push(b)};this.addNext=function(e){for(var c=[],d=0,b=0;b<a.length;b++){if(!a[b])continue;d==1&&c.push(e);c.push(a[b]);d++}d<2&&c.push(e);a=c};this.get=function(){for(var b=0;b<a.length;b++)if(a[b])return a[b];return false};this.ack=function(){for(var b=0;b<a.length;b++)if(a[b]){delete a[b];break}if(this.empty())a=[]}}function w(){var b={};this.add=function(c,e,d){c=c.toLowerCase();if(!b[c])b[c]=[];b[c].push({obj:e,tag:a(d,"tag")});return c+"-"+(b[c].length-1)};this.get=function(a,g,f){var e,c,h;a=a.toLowerCase();if(!b[a]||!b[a].length)return null;c=g?b[a].length:-1;h=g?-1:1;for(e=0;e<b[a].length;e++){c+=h;if(b[a][c]){if(f!==undefined)if(b[a][c].tag===undefined||d.inArray(b[a][c].tag,f)<0)continue;return b[a][c].obj}}return null};this.all=function(a,f){var c,e=[];a=a.toLowerCase();if(!b[a]||!b[a].length)return e;for(c=0;c<b[a].length;c++){if(!b[a][c])continue;if(f!==undefined&&(b[a][c].tag===undefined||d.inArray(b[a][c].tag,f)<0))continue;e.push(b[a][c].obj)}return e};this.names=function(){var c,a=[];for(c in b)a.push(c);return a};this.refToObj=function(a){a=a.split("-");return a.length==2&&b[a[0]]&&b[a[0]][a[1]]?b[a[0]][a[1]].obj:null};this.rm=function(a,f,g){var c,e,h;a=a.toLowerCase();if(!b[a])return false;if(f!==undefined){if(g){for(c=b[a].length-1;c>=0;c--)if(b[a][c]!==undefined&&b[a][c].tag!==undefined&&d.inArray(b[a][c].tag,f)>=0)break}else for(c=0;c<b[a].length;c++)if(b[a][c]!==undefined&&b[a][c].tag!==undefined&&d.inArray(b[a][c].tag,f)>=0)break}else c=g?b[a].length-1:0;if(!(c in b[a]))return false;typeof b[a][c].obj.setMap==="function"&&b[a][c].obj.setMap(null);typeof b[a][c].obj.remove==="function"&&b[a][c].obj.remove();typeof b[a][c].obj.free==="function"&&b[a][c].obj.free();delete b[a][c].obj;if(f!==undefined){h=[];for(e=0;e<b[a].length;e++)e!==c&&h.push(b[a][e]);b[a]=h}else if(g)b[a].pop();else b[a].shift();return true};this.clear=function(a,h,i,e){var g,d,c;if(!a||!a.length){a=[];for(g in b)a.push(g)}else a=f(a);for(d=0;d<a.length;d++)if(a[d]){c=a[d].toLowerCase();if(!b[c])continue;if(h)this.rm(c,e,true);else if(i)this.rm(c,e,false);else while(this.rm(c,e,false));}}}function C(){var b=[],c=[],a=[],f=[],e=false,g;this.events=function(){for(var a=0;a<arguments.length;a++)c.push(arguments[a])};this.startRedraw=function(){if(!e){e=true;return true}return false};this.endRedraw=function(){e=false};this.redraw=function(){for(var a=[],c=this,b=0;b<arguments.length;b++)a.push(arguments[b]);if(this.startRedraw){g.apply(c,a);this.endRedraw()}else setTimeout(function(){c.redraw.apply(c,a)},50)};this.setRedraw=function(a){g=a};this.store=function(b,c,d){a.push({data:b,obj:c,shadow:d})};this.free=function(){for(var a=0;a<c.length;a++)google.maps.event.removeListener(c[a]);c=[];this.freeAll()};this.freeIndex=function(b){typeof a[b].obj.setMap==="function"&&a[b].obj.setMap(null);typeof a[b].obj.remove==="function"&&a[b].obj.remove();if(a[b].shadow){typeof a[b].shadow.remove==="function"&&a[b].obj.remove();typeof a[b].shadow.setMap==="function"&&a[b].shadow.setMap(null);delete a[b].shadow}delete a[b].obj;delete a[b].data;delete a[b]};this.freeAll=function(){for(var b=0;b<a.length;b++)a[b]&&this.freeIndex(b);a=[]};this.freeDiff=function(f){for(var c,g={},e=[],b=0;b<f.length;b++)e.push(f[b].idx.join("-"));for(b=0;b<a.length;b++){if(!a[b])continue;c=d.inArray(a[b].data.idx.join("-"),e);if(c>=0)g[c]=true;else this.freeIndex(b)}return g};this.add=function(c,a){b.push({latLng:c,marker:a})};this.get=function(a){return b[a]};this.clusters=function(k,w,z,C){var x=k.getProjection(),v=x.fromLatLngToPoint(new google.maps.LatLng(k.getBounds().getNorthEast().lat(),k.getBounds().getSouthWest().lng())),a,p,r,m,l,u,g,h,t=k.getZoom(),i={},c={},j={},y=[],e,n,s,q,d,o,D=k.getBounds(),A=z&&z<=k.getZoom(),B=k.getZoom()>2;o=0;d={};for(a=0;a<b.length;a++){if(B&&!D.contains(b[a].latLng))continue;m=x.fromLatLngToPoint(b[a].latLng);i[a]=[Math.floor((m.x-v.x)*Math.pow(2,t)),Math.floor((m.y-v.y)*Math.pow(2,t))];d[a]=true;o++}if(!C&&!A){for(g=0;g<f.length;g++)if(g in d)o--;else break;if(!o)return false}f=d;d=[];for(a in i){l=i[a][0];u=i[a][1];if(!(l in c))c[l]={};if(!(u in c[l])){c[l][u]=a;j[a]={};d.push(a)}j[c[l][u]][a]=true}w=Math.pow(w,2);delete c;g=0;while(1){while(g<d.length&&!(d[g]in j))g++;if(g==d.length)break;a=d[g];s=i[a][0];q=i[a][1];c=null;if(A)c={lat:s,lng:q,idx:[a]};else do{e={lat:0,lng:0,idx:[]};for(h=g;h<d.length;h++){if(!(d[h]in j))continue;p=d[h];if(Math.pow(s-i[p][0],2)+Math.pow(q-i[p][1],2)<=w)for(r in j[p]){e.lat+=b[r].latLng.lat();e.lng+=b[r].latLng.lng();e.idx.push(r)}}e.lat/=e.idx.length;e.lng/=e.idx.length;if(!c){n=e.idx.length>1;c=e}else{n=e.idx.length>c.idx.length;if(n)c=e}if(n){m=x.fromLatLngToPoint(new google.maps.LatLng(c.lat,c.lng));s=Math.floor((m.x-v.x)*Math.pow(2,t));q=Math.floor((m.y-v.y)*Math.pow(2,t))}}while(n);for(h=0;h<c.idx.length;h++)if(c.idx[h]in j)delete j[c.idx[h]];y.push(c)}return y};this.getBounds=function(){for(var c=new google.maps.LatLngBounds,a=0;a<b.length;a++)c.extend(b[a].latLng);return c}}var b={verbose:false,queryLimit:{attempt:5,delay:250,random:250},init:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType}},g=["events","onces","options","apply","callback","data","tag"],o=["init","geolatlng","getlatlng","getroute","getelevation","getdistance","addstyledmap","setdefault","destroy"],r=["get"],l=directionsService=elevationService=maxZoomService=distanceMatrixService=null;function m(c){for(var a in c)if(typeof b[a]==="object")b[a]=d.extend({},b[a],c[a]);else b[a]=c[a]}function z(b){if(!b)return true;for(var a=0;a<o.length;a++)if(o[a]===b)return false;return true}function v(c){for(var d=a(c,"action"),b=0;b<r.length;b++)if(r[b]===d)return true;return false}function i(c,a){if(a.toLowerCase){a=a.toLowerCase();for(var b in c)if(b.toLowerCase&&b.toLowerCase()==a)return b}return false}function a(b,c,d){var a=i(b,c);return a?b[a]:d}function h(d,a){var b,c;if(!d||!a)return false;a=f(a);for(b in d)if(b.toLowerCase){b=b.toLowerCase();for(c in a)if(b==a[c])return true}return false}function n(c,e,d){if(h(c,g)||h(c,e)){for(var a,b=0;b<g.length;b++){a=i(c,g[b]);d[g[b]]=a?c[a]:{}}if(e&&e.length)for(b=0;b<e.length;b++)if(a=i(c,e[b]))d[e[b]]=c[a];return d}else{d.options={};for(a in c)if(a!=="action")d.options[a]=c[a];return d}}function e(m,e,j,d){var l=i(e,m),b,c={},k=["map"];c.callback=a(e,"callback");j=f(j);d=f(d);if(l)return n(e[l],j,c);if(d&&d.length)for(b=0;b<d.length;b++)k.push(d[b]);if(!h(e,k))c=n(e,j,c);for(b=0;b<g.length;b++){if(g[b]in c)continue;c[g[b]]={}}return c}function q(){if(!l)l=new google.maps.Geocoder;return l}function t(){if(!directionsService)directionsService=new google.maps.DirectionsService;return directionsService}function s(){if(!elevationService)elevationService=new google.maps.ElevationService;return elevationService}function B(){if(!maxZoomService)maxZoomService=new google.maps.MaxZoomService;return maxZoomService}function u(){if(!distanceMatrixService)distanceMatrixService=new google.maps.DistanceMatrixService;return distanceMatrixService}function j(a){return(typeof a==="number"||typeof a==="string")&&a!==""&&!isNaN(a)}function f(a){var c,b=[];if(a!==undefined)if(typeof a==="object")if(typeof a.length==="number")b=a;else for(c in a)b.push(a[c]);else b.push(a);return b}function c(a,e,d){var b=e?a:null;return!a||typeof a==="string"?b:a.latLng?c(a.latLng):typeof a.lat==="function"?a:j(a.lat)?new google.maps.LatLng(a.lat,a.lng):!d&&a.length?!j(a[0])||!j(a[1])?b:new google.maps.LatLng(a[0],a[1]):b}function p(a,g,f){var d,b,e;if(!a)return null;e=f?a:null;if(typeof a.getCenter==="function")return a;if(a.length){if(a.length==2){d=c(a[0]);b=c(a[1])}else if(a.length==4){d=c([a[0],a[1]]);b=c([a[2],a[3]])}}else if("ne"in a&&"sw"in a){d=c(a.ne);b=c(a.sw)}else if("n"in a&&"e"in a&&"s"in a&&"w"in a){d=c([a.n,a.e]);b=c([a.s,a.w])}return d&&b?new google.maps.LatLngBounds(b,d):e}function A(j){var n=new x,i=new w,g=null,l={},o=false;this._plan=function(b){for(var a=0;a<b.length;a++)n.add(b[a]);this._run()};this._planNext=function(a){n.addNext(a)};this._direct=function(c){var e=a(c,"action");return this[e](d.extend({},e in b?b[e]:{},c.args?c.args:c))};this._end=function(){o=false;n.ack();this._run()},this._run=function(){if(o)return;var a=n.get();if(!a)return;o=true;this._proceed(a)};this._proceed=function(c){c=c||{};var f=a(c,"action")||"init",e=f.toLowerCase(),j=true,h=a(c,"target"),k=a(c,"args"),i;!g&&z(e)&&this.init(d.extend({},b.init,c.args&&c.args.map?c.args.map:c.map?c.map:{}),true);if(!h&&!k&&e in this&&typeof this[e]==="function")this[e](d.extend({},e in b?b[e]:{},c.args?c.args:c));else{if(h&&typeof h==="object"){if(j=typeof h[f]==="function")i=h[f].apply(h,c.args?c.args:[])}else if(g)if(j=typeof g[f]==="function")i=g[f].apply(g,c.args?c.args:[]);!j&&b.verbose&&alert("unknown action : "+f);this._callback(i,c);this._end()}};this._resolveLatLng=function(d,h,k,g){var f=a(d,"address"),j,e=this,i=typeof h==="function"?h:e[h];if(f){if(!g)g=0;if(typeof f==="object")j=f;else j={address:f};q().geocode(j,function(c,a){if(a===google.maps.GeocoderStatus.OK)i.apply(e,[d,k?c:c[0].geometry.location]);else if(a===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&g<b.queryLimit.attempt)setTimeout(function(){e._resolveLatLng(d,h,k,g+1)},b.queryLimit.delay+Math.floor(Math.random()*b.queryLimit.random));else{b.verbose&&alert("Geocode error : "+a);i.apply(e,[d,false])}})}else i.apply(e,[d,c(d,false,true)])};this._resolveAllLatLng=function(a,c,f){var d=this,b=-1,e=function(){do b++;while(b<a[c].length&&!("address"in a[c][b]));if(b<a[c].length)(function(a){d._resolveLatLng(a,function(a,b){a.latLng=b;e.apply(d,[])})})(a[c][b]);else d[f](a)};e()};this._call=function(){var a,c=arguments[0],b=[];if(!arguments.length||!g||typeof g[c]!=="function")return;for(a=1;a<arguments.length;a++)b.push(arguments[a]);return g[c].apply(g,b)};this._subcall=function(b,c){var e={};if(!b.map)return;if(!c)c=a(b.map,"latlng");if(!g){if(c)e={center:c};this.init(d.extend({},b.map,e),true)}else{b.map.center&&c&&this._call("setCenter",c);b.map.zoom!==undefined&&this._call("setZoom",b.map.zoom);b.map.mapTypeId!==undefined&&this._call("setMapTypeId",b.map.mapTypeId)}};this._attachEvent=function(a,b,e,d,c){google.maps.event["addListener"+(c?"Once":"")](a,b,function(b){e.apply(j,[a,b,d])})};this._attachEvents=function(c,a){var b;if(!a)return;if(a.events)for(b in a.events)typeof a.events[b]==="function"&&this._attachEvent(c,b,a.events[b],a.data,false);if(a.onces)for(b in a.onces)typeof a.onces[b]==="function"&&this._attachEvent(c,b,a.onces[b],a.data,true)};this._callback=function(c,a){if(typeof a.callback==="function")a.callback.apply(j,[c]);else if(typeof a.callback==="object")for(var b=0;b<a.callback.length;b++)typeof a.callback[b]==="function"&&a.callback[k].apply(j,[c])};this._manageEnd=function(a,c,e){var d,b;if(a&&typeof a==="object"){this._attachEvents(a,c);if(c.apply&&c.apply.length)for(d=0;d<c.apply.length;d++){b=c.apply[d];if(!b.action||typeof a[b.action]!=="function")continue;if(b.args)a[b.action].apply(a,b.args);else a[b.action]()}}if(!e){this._callback(a,c);this._end()}};this.destroy=function(b){var a;i.clear();j.empty();for(a in l)delete l[a];l={};if(g)delete g;this._callback(null,b);this._end()};this.init=function(i,k){var f,h,a;if(g)return this._end();f=e("map",i);if(typeof f.options.center==="boolean"&&f.options.center)return false;a=d.extend({},b.init,f.options);if(!a.center)a.center=[b.init.center.lat,b.init.center.lng];a.center=c(a.center);g=new b.classes.Map(j.get(0),a);for(h in l)g.mapTypes.set(h,l[h]);this._manageEnd(g,f,k);return true};this.getlatlng=function(a){this._resolveLatLng(a,"_getLatLng",true)},this._getLatLng=function(a,b){this._manageEnd(b,a)},this.getaddress=function(d,f){var h=c(d,false,true),e=a(d,"address"),i=h?{latLng:h}:e?typeof e==="string"?{address:e}:e:null,k=a(d,"callback"),g=this;if(!f)f=0;if(i&&typeof k==="function")q().geocode(i,function(e,a){if(a===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&f<b.queryLimit.attempt)setTimeout(function(){g.getaddress(d,f+1)},b.queryLimit.delay+Math.floor(Math.random()*b.queryLimit.random));else{var c=a===google.maps.GeocoderStatus.OK?e:false;k.apply(j,[c,a]);!c&&b.verbose&&alert("Geocode error : "+a);g._end()}});else this._end()};this.getroute=function(b){var d=a(b,"callback"),e=this;if(typeof d==="function"&&b.options){b.options.origin=c(b.options.origin,true);b.options.destination=c(b.options.destination,true);t().route(b.options,function(c,a){var b=a==google.maps.DirectionsStatus.OK?c:false;d.apply(j,[b,a]);e._end()})}else this._end()};this.getelevation=function(e){var h,g,i,d,b=[],l=a(e,"callback"),k=a(e,"latlng"),m=this;if(typeof l==="function"){h=function(c,a){var b=a===google.maps.ElevationStatus.OK?c:false;l.apply(j,[b,a]);m._end()};if(k)b.push(c(k));else{b=a(e,"locations")||[];if(b){b=f(b);for(d=0;d<b.length;d++)b[d]=c(b[d])}}if(b.length)s().getElevationForLocations({locations:b},h);else{g=a(e,"path");i=a(e,"samples");if(g&&i){for(d=0;d<g.length;d++)b.push(c(g[d]));b.length&&s().getElevationAlongPath({path:b,samples:i},h)}}}else this._end()};this.getdistance=function(b){var d,e=a(b,"callback"),g=this;if(typeof e==="function"&&b.options&&b.options.origins&&b.options.destinations){b.options.origins=f(b.options.origins);for(d=0;d<b.options.origins.length;d++)b.options.origins[d]=c(b.options.origins[d],true);b.options.destinations=f(b.options.destinations);for(d=0;d<b.options.destinations.length;d++)b.options.destinations[d]=c(b.options.destinations[d],true);u().getDistanceMatrix(b.options,function(c,a){var b=a==google.maps.DistanceMatrixStatus.OK?c:false;e.apply(j,[b,a]);g._end()})}else this._end()};this.addmarker=function(a){this._resolveLatLng(a,"_addMarker")};this._addMarker=function(k,l,m){var c,d,j,a=e("marker",k,"to");if(!m){if(!l){this._manageEnd(false,a);return}this._subcall(k,l)}else if(!l)return;if(a.to){j=i.refToObj(a.to);c=j&&typeof j.add==="function";if(c){j.add(l,k);typeof j.redraw==="function"&&j.redraw()}!m&&this._manageEnd(c,a)}else{a.options.position=l;a.options.map=g;c=new b.classes.Marker(a.options);if(h(k,"infowindow")){d=e("infowindow",k.infowindow,"open");if(d.open===undefined||d.open){d.apply=f(d.apply);d.apply.unshift({action:"open",args:[g,c]})}d.action="addinfowindow";this._planNext(d)}if(!m){i.add("marker",c,a);this._manageEnd(c,a)}}return c};this.addmarkers=function(b){if(a(b,"clusters"))this._resolveAllLatLng(b,"markers","_addclusteredmarkers");else this._resolveAllLatLng(b,"markers","_addmarkers")};this._addmarkers=function(o){var l,f,h,n,p,m={},q,k,j=a(o,"markers");this._subcall(o);if(typeof j!=="object")return this._end();f=e("marker",o,["to","markers"]);if(f.to){k=i.refToObj(f.to);l=k&&typeof k.add==="function";if(l){for(h=0;h<j.length;h++)(n=c(j[h]))&&k.add(n,j[h]);typeof k.redraw==="function"&&k.redraw()}this._manageEnd(l,f)}else{d.extend(true,m,f.options);m.map=g;l=[];for(h=0;h<j.length;h++)if(n=c(j[h])){if(j[h].options){q={};d.extend(true,q,m,j[h].options);f.options=q}else f.options=m;f.options.position=n;p=new b.classes.Marker(f.options);l.push(p);f.data=j[h].data;f.tag=j[h].tag;i.add("marker",p,f);this._manageEnd(p,f,true)}f.options=m;this._callback(l,o);this._end()}};this._addclusteredmarkers=function(b){var f,d,h,j,k=this,i=a(b,"radius"),l=a(b,"maxZoom"),e=a(b,"markers"),m=a(b,"clusters");if(!g.getBounds()){google.maps.event.addListenerOnce(g,"bounds_changed",function(){k._addclusteredmarkers(b)});return}if(typeof i==="number"){f=new C;for(d=0;d<e.length;d++){h=c(e[d]);f.add(h,e[d])}j=this._initClusters(b,f,i,l,m)}this._callback(j,b);this._end()};this._initClusters=function(b,a,c,d,f){var e=this;a.setRedraw(function(j){var i,h=a.clusters(g,c,d,j);if(h){i=a.freeDiff(h);e._displayClusters(b,a,h,i,f)}});a.events(google.maps.event.addListener(g,"zoom_changed",function(){a.redraw(true)}),google.maps.event.addListener(g,"bounds_changed",function(){a.redraw()}));a.redraw();return i.add("cluster",a,b)};this._displayClusters=function(n,q,x,y,l){for(var p,j,f,w,m,u,b,k,t,v,s,i,o=h(n,"cluster")?e("",a(n,"cluster")):{},g=h(n,"marker")?e("",a(n,"marker")):{},r=0;r<x.length;r++){if(r in y)continue;b=x[r];w=false;if(b.idx.length>1){f=0;for(p in l)if(p>f&&p<=b.idx.length)f=p;if(l[f]){v=a(l[f],"width");s=a(l[f],"height");i={};d.extend(true,i,o,{options:{pane:"overlayLayer",content:l[f].content.replace("CLUSTER_COUNT",b.idx.length),offset:{x:-v/2,y:-s/2}}});m=this._addOverlay(i,c(b),true);i.options.pane="floatShadow";i.options.content=d("<div></div>");i.options.content.width(v);i.options.content.height(s);u=this._addOverlay(i,c(b),true);o.data={latLng:c(b),markers:[]};for(j=0;j<b.idx.length;j++)o.data.markers.push(q.get(b.idx[j]).marker);this._attachEvents(u,o);q.store(b,m,u);w=true}}if(!w){k={};d.extend(true,k,g.options);for(j=0;j<b.idx.length;j++){f=q.get(b.idx[j]);g.latLng=f.latLng;g.data=f.marker.data;g.tag=f.marker.tag;if(f.marker.options){t={};d.extend(true,t,k,f.marker.options);g.options=t}else g.options=k;m=this._addMarker(g,g.latLng,true);this._attachEvents(m,g);q.store(b,m)}g.options=k}}};this.addinfowindow=function(a){this._resolveLatLng(a,"_addInfoWindow")};this._addInfoWindow=function(j,d){var a,h,c=[];this._subcall(j,d);a=e("infowindow",j,["open","anchor"]);if(d)a.options.position=d;h=new b.classes.InfoWindow(a.options);if(a.open===undefined||a.open){a.apply=f(a.apply);c.push(g);a.anchor&&c.push(a.anchor);a.apply.unshift({action:"open",args:c})}i.add("infowindow",h,a);this._manageEnd(h,a)};this.addpolyline=function(a){this._addPoly(a,"Polyline","path")};this.addpolygon=function(a){this._addPoly(a,"Polygon","paths")};this._addPoly=function(k,h,b){var d,f,j,a=e(h.toLowerCase(),k,b);if(a[b]){a.options[b]=[];for(d=0;d<a[b].length;d++)(j=c(a[b][d]))&&a.options[b].push(j)}f=new google.maps[h](a.options);f.setMap(g);i.add(h.toLowerCase(),f,a);this._manageEnd(f,a)};this.addcircle=function(a){this._resolveLatLng(a,"_addCircle")};this._addCircle=function(h,d){var f,a=e("circle",h);if(!d)d=c(a.options.center);if(!d)return this._manageEnd(false,a);this._subcall(h,d);a.options.center=d;a.options.map=g;f=new b.classes.Circle(a.options);i.add("circle",f,a);this._manageEnd(f,a)};this.addrectangle=function(a){this._resolveLatLng(a,"_addRectangle")};this._addRectangle=function(d){var c,a=e("rectangle",d);a.options.bounds=p(a.options.bounds,true);if(!a.options.bounds)return this._manageEnd(false,a);this._subcall(d,a.options.bounds.getCenter());a.options.map=g;c=new b.classes.Rectangle(a.options);i.add("rectangle",c,a);this._manageEnd(c,a)};this.addoverlay=function(a){this._resolveLatLng(a,"_addOverlay")};this._addOverlay=function(m,l,n){var h,k=e("overlay",m),f=d.extend({pane:"floatPane",content:"",offset:{x:0,y:0}},k.options),a=d("<div></div>"),j=[];a.css("border","none").css("borderWidth","0px").css("position","absolute");a.append(f.content);function c(){b.classes.OverlayView.call(this);this.setMap(g)}c.prototype=new b.classes.OverlayView;c.prototype.onAdd=function(){var b=this.getPanes();f.pane in b&&d(b[f.pane]).append(a)};c.prototype.draw=function(){var e=this.getProjection(),c=e.fromLatLngToDivPixel(l),b=this;a.css("left",c.x+f.offset.x+"px").css("top",c.y+f.offset.y+"px");d.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(d,c){j.push(google.maps.event.addDomListener(a[0],c,function(){google.maps.event.trigger(b,c)}))});j.push(google.maps.event.addDomListener(a[0],"contextmenu",function(){google.maps.event.trigger(b,"rightclick")}))};c.prototype.onRemove=function(){for(var b=0;b<j.length;b++)google.maps.event.removeListener(j[b]);a.remove()};c.prototype.hide=function(){a.hide()};c.prototype.show=function(){a.show()};c.prototype.toggle=function(){if(a)if(a.is(":visible"))this.show();else this.hide()};c.prototype.toggleDOM=function(){if(this.getMap())this.setMap(null);else this.setMap(g)};c.prototype.getDOMElement=function(){return a[0]};h=new c;if(!n){i.add("overlay",h,k);this._manageEnd(h,k)}return h};this.addfixpanel=function(h){var a=e("fixpanel",h),c=y=0,b,f;if(a.options.content){b=d(a.options.content);if(a.options.left!==undefined)c=a.options.left;else if(a.options.right!==undefined)c=j.width()-b.width()-a.options.right;else if(a.options.center)c=(j.width()-b.width())/2;if(a.options.top!==undefined)y=a.options.top;else if(a.options.bottom!==undefined)y=j.height()-b.height()-a.options.bottom;else if(a.options.middle)y=(j.height()-b.height())/2;f=d("<div></div>").css("position","absolute").css("top",y+"px").css("left",c+"px").css("z-index","1000").append(b);j.first().prepend(f);this._attachEvents(g,a);i.add("fixpanel",f,a);this._callback(f,a)}this._end()};this.adddirectionsrenderer=function(c,d){var b,a=e("directionrenderer",c,"panelId");a.options.map=g;b=new google.maps.DirectionsRenderer(a.options);a.panelId&&b.setPanel(document.getElementById(a.panelId));i.add("directionrenderer",b,a);this._manageEnd(b,a,d);return b};this.setdirectionspanel=function(c){var a=i.get("directionrenderer"),b=e("directionpanel",c,"id");a&&b.id&&a.setPanel(document.getElementById(b.id));this._manageEnd(a,b)};this.setdirections=function(a){var c=i.get("directionrenderer"),b=e("directions",a);if(a)b.options.directions=a.directions?a.directions:a.options&&a.options.directions?a.options.directions:null;if(b.options.directions)if(!c)c=this.adddirectionsrenderer(b,true);else c.setDirections(b.options.directions);this._manageEnd(c,b)};this.setstreetview=function(f){var d,a=e("streetview",f,"id");if(a.options.position)a.options.position=c(a.options.position);d=new b.classes.StreetViewPanorama(document.getElementById(a.id),a.options);d&&g.setStreetView(d);this._manageEnd(d,a)};this.addkmllayer=function(d){var c,a=e("kmllayer",d,"url");a.options.map=g;if(typeof a.url==="string")c=new b.classes.KmlLayer(a.url,a.options);i.add("kmllayer",c,a);this._manageEnd(c,a)};this.addtrafficlayer=function(d){var c=e("trafficlayer",d),a=i.get("trafficlayer");if(!a){a=new b.classes.TrafficLayer;a.setMap(g);i.add("trafficlayer",a,c)}this._manageEnd(a,c)};this.addbicyclinglayer=function(d){var c=e("bicyclinglayer",d),a=i.get("bicyclinglayer");if(!a){a=new b.classes.BicyclingLayer;a.setMap(g);i.add("bicyclinglayer",a,c)}this._manageEnd(a,c)};this.addgroundoverlay=function(d){var c,a=e("groundoverlay",d,["bounds","url"]);a.bounds=p(a.bounds);if(a.bounds&&typeof a.url==="string"){c=new b.classes.GroundOverlay(a.url,a.bounds);c.setMap(g);i.add("groundoverlay",c,a)}this._manageEnd(c,a)};this.geolatlng=function(c){var b=a(c,"callback");if(typeof b==="function")if(navigator.geolocation)navigator.geolocation.getCurrentPosition(function(a){var c=new google.maps.LatLng(a.coords.latitude,a.coords.longitude);b.apply(j,[c])},function(){var a=false;b.apply(j,[a])});else if(google.gears)google.gears.factory.create("beta.geolocation").getCurrentPosition(function(a){var c=new google.maps.LatLng(a.latitude,a.longitude);b.apply(j,[c])},function(){out=false;b.apply(j,[out])});else b.apply(j,[false]);this._end()};this.addstyledmap=function(c,d){var a=e("styledmap",c,["id","style"]);if(a.style&&a.id&&!l[a.id]){l[a.id]=new b.classes.StyledMapType(a.style,a.options);g&&g.mapTypes.set(a.id,l[a.id])}this._manageEnd(l[a.id],a,d)};this.setstyledmap=function(b){var a=e("styledmap",b,["id","style"]);if(a.id){this.addstyledmap(a,true);if(l[a.id]){g.setMapTypeId(a.id);this._callback(l[a.id],b)}}this._manageEnd(l[a.id],a)};this.clear=function(b){var e=f(a(b,"list")||a(b,"name")),d=a(b,"last",false),g=a(b,"first",false),c=a(b,"tag");if(c!==undefined)c=f(c);i.clear(e,d,g,c);this._end()};this.get=function(d){var c=a(d,"name")||"map",h=a(d,"first"),e=a(d,"all"),b=a(d,"tag");c=c.toLowerCase();if(c==="map")return g;if(b!==undefined)b=f(b);return h?i.get(c,false,b):e?i.all(c,b):i.get(c,true,b)};this.getmaxzoom=function(a){this._resolveLatLng(a,"_getMaxZoom")};this._getMaxZoom=function(c,e){var b=a(c,"callback"),d=this;if(b&&typeof b==="function")B().getMaxZoomAtLatLng(e,function(a){var c=a.status===google.maps.MaxZoomStatus.OK?a.zoom:false;b.apply(j,[c,a.status]);d._end()});else this._end()};this.setdefault=function(a){m(a);this._end()};this.autofit=function(l,m){var j,h,b,f,e,d=true,c=new google.maps.LatLngBounds,k=a(l,"maxZoom",null);j=i.names();for(f=0;f<j.length;f++){h=i.all(j[f]);for(e=0;e<h.length;e++){b=h[e];if(b.getPosition){c.extend(b.getPosition());d=false}else if(b.getBounds){c.extend(b.getBounds().getNorthEast());c.extend(b.getBounds().getSouthWest());d=false}else if(b.getPaths)b.getPaths().forEach(function(a){a.forEach(function(a){c.extend(a);d=false})});else if(b.getPath)b.getPath().forEach(function(a){c.extend(a);d=false});else if(b.getCenter){c.extend(b.getCenter());d=false}}}if(!d&&(!g.getBounds()||!g.getBounds().equals(c))){k!==null&&google.maps.event.addListenerOnce(g,"bounds_changed",function(){this.getZoom()>k&&this.setZoom(k)});g.fitBounds(c)}!m&&this._manageEnd(d?false:c,l,m)}}d.fn.gmap3=function(){for(var b,a=[],f=true,c=[],e=0;e<arguments.length;e++){b=arguments[e]||{};if(typeof b==="string")b={action:b};a.push(b)}!a.length&&a.push({});d.each(this,function(){var e=d(this),b=e.data("gmap3");f=false;if(!b){b=new A(e);e.data("gmap3",b)}if(a.length==1&&v(a[0]))c.push(b._direct(a[0]));else b._plan(a)});if(c.length)return c.length===1?c[0]:c;f&&arguments.length==2&&typeof arguments[0]==="string"&&arguments[0].toLowerCase()==="setdefault"&&m(arguments[1]);return this}})(jQuery)