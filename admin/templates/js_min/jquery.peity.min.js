(function(a,e){function d(b,d){var a=e.createElement("canvas");a.setAttribute("width",b*c);a.setAttribute("height",d*c);c!=1&&a.setAttribute("style","width:"+b+"px;height:"+d+"px");return a}var b=a.fn.peity=function(c,d){e.createElement("canvas").getContext&&this.each(function(){a(this).change(function(){var e=a.extend({},d),f=this;a.each(e,function(c,b){a.isFunction(b)&&(e[c]=b.call(f))});var g=a(this).html();b.graphers[c].call(this,a.extend({},b.defaults[c],e));a(this).trigger("chart:changed",g)}).trigger("change")});return this};b.graphers={};b.defaults={};b.add=function(a,d,c){b.graphers[a]=c;b.defaults[a]=d};var c=window.devicePixelRatio||1;b.add("pie",{colours:["#FFF4DD","#FF9900"],delimeter:"/",diameter:16},function(f){var i=a(this),e=i.text().split(f.delimeter),g=parseFloat(e[0]),h=parseFloat(e[1]),e=-Math.PI/2,g=g/h*Math.PI*2,h=d(f.diameter,f.diameter),c=h.getContext("2d"),b=h.width/2;c.beginPath();c.moveTo(b,b);c.arc(b,b,b,g+e,g==0?Math.PI*2:e,!1);c.fillStyle=f.colours[0];c.fill();c.beginPath();c.moveTo(b,b);c.arc(b,b,b,e,g+e,!1);c.fillStyle=f.colours[1];c.fill();i.wrapInner(a("<span>").hide()).append(h)});b.add("line",{colour:"#c6d9fd",strokeColour:"#4d89f9",strokeWidth:1,delimeter:",",height:16,max:null,min:0,width:32},function(f){var n=a(this),i=d(f.width,f.height),g=n.text().split(f.delimeter);g.length==1&&g.push(g[0]);var k=Math.max.apply(Math,g.concat([f.max])),j=Math.min.apply(Math,g.concat([f.min])),b=i.getContext("2d"),m=i.width,l=i.height,q=m/(g.length-1),k=l/(k-j),h=[],e;b.beginPath();b.moveTo(0,l+j*k);for(e=0;e<g.length;e++){var o=e*q,p=l-k*(g[e]-j);h.push({x:o,y:p});b.lineTo(o,p)}b.lineTo(m,l+j*k);b.fillStyle=f.colour;b.fill();if(f.strokeWidth){b.beginPath();b.moveTo(0,h[0].y);for(e=0;e<h.length;e++)b.lineTo(h[e].x,h[e].y);b.lineWidth=f.strokeWidth*c;b.strokeStyle=f.strokeColour;b.stroke()}n.wrapInner(a("<span>").hide()).append(i)});b.add("bar",{colour:"#4D89F9",delimeter:",",height:16,max:null,min:0,width:32},function(b){var k=a(this),e=k.text().split(b.delimeter),g=Math.max.apply(Math,e.concat([b.max])),i=Math.min.apply(Math,e.concat([b.min])),f=d(b.width,b.height),h=f.getContext("2d"),j=f.height,g=j/(g-i),m=c/2,l=(f.width+m)/e.length;h.fillStyle=b.colour;for(b=0;b<e.length;b++)h.fillRect(b*l,j-g*(e[b]-i),l-m,g*e[b]);k.wrapInner(a("<span>").hide()).append(f)})})(jQuery,document)