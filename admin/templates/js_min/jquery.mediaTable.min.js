(function(a){var d=function(f,g){var e=a(this),d=e.data("MediaTable");a.isEmptyObject(d)&&(d={$wrap:a("<div>"),$table:e,$menu:!1,cfg:f,id:e.attr("id")},d.id||(d.id="MediaTable-"+g,d.$table.attr("id",d.id)),d.$table.addClass("activeMediaTable"),d.$wrap.addClass("mediaTableWrapper"),d.$table.before(d.$wrap).appendTo(d.$wrap),d.cfg.menu&&b(d),d.$table.find("thead th").each(function(a){c.call(this,a,d)}),d.$table.data("MediaTable",d))},b=function(b){b.$menu=a('<div class="btn-group" />');b.$menu.$header=a('<a class="btn btn-small dropdown-toggle" data-toggle="dropdown" href="#" />');b.$menu.$list=a('<ul class="dropdown-menu" />');b.$menu.addClass("mediaTableMenu").addClass("mediaTableMenuClosed").append(b.$menu.$header).append(b.$menu.$list);b.$wrap.addClass("mediaTableWrapperWithMenu");b.$menu.$header.html(b.cfg.menuTitle+' <span class="caret"></span>');b.$table.before(b.$menu);a(window).bind("orientationchange resize",function(){b.$menu.find("input").trigger("updateCheck")});b.$menu.$header.bind("click",function(){b.$menu.toggleClass("mediaTableMenuClosed")});b.$menu.$list.bind("mouseleave",function(){b.$menu.toggleClass("mediaTableMenuClosed")})},c=function(f,b){var c=a(this),d=c.attr("id"),g=c.attr("class");d||(d=b.id+"-mediaTableCol-"+f,c.attr("id",d));if(b.cfg.menu&&!c.is(".persist")){var h=a('<li><label for="toggle-col-'+b.id+"-"+f+'" class="checkbox"><input type="checkbox" name="toggle-cols" id="toggle-col-'+b.id+"-"+f+'" value="'+d+'" /> '+c.text()+"</label></li>");b.$menu.$list.append(h);e(c,h.find("input"),b)}a("tbody tr",b.$table).each(function(){var c=d,b=a(this).find("td,th").eq(f);b.attr("headers",c);g&&b.attr("class",g)})},e=function(b,a,c){a.bind("change",function(){var b=a.val(),b=c.$table.find("#"+b+", [headers="+b+"]");a.is(":checked")?b.show():b.hide()}).bind("updateCheck",function(){b.is(":visible")?a.attr("checked",!0):a.attr("checked",!1)}).trigger("updateCheck")};a.fn.mediaTable=function(){var b=!1;if(!arguments.length||a.isPlainObject(arguments[0]))b=a.extend({},{menu:!0,menuTitle:"Columns",t:"e"},arguments[0]);if(!1!==b)a(this).each(function(a){d.call(this,b,a)});else if(arguments.length)switch(arguments[0]){case"destroy":a(this).each(function(){var b=a(this).data("MediaTable");b&&(b.$wrap.after(b.$table).remove(),b.$table.removeClass("activeMediaTable"),b.$table.data("MediaTable",null))})}return this}})(jQuery)