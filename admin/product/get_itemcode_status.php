<?php
 define('IN_DAEM', true); include_once '../includes/init.php'; include_once './product.func.php'; include_once './specialConfig.php'; $date = empty($_GET['date']) ? date('Ymd') : date('Ymd',strtotime($_GET['date'])); $endDate = empty($_GET['endDate']) ? date('Ymd') : date('Ymd',strtotime($_GET['endDate'])); try { $client = new SoapClient("http://10.2.8.174:8780/BaanWebservice/services/baanGetItemByLcsj?wsdl"); $param['in0'] = $date; $param['in1'] = $endDate; $arrResult2 = $client->getItems($param)->out; } catch (SOAPFault $e) { print $e; } $resultStr = '['.$arrResult2.']'; $checkDataAry = json_decode($resultStr,true); $dataAry = array(); foreach($checkDataAry as $key=>$val) { $dataAry[$val['item']] = $val; } $checkStr = ''; foreach($checkDataAry as $key=>$val) { $checkStr .= "'".$val['item']."',"; } $checkStr = trim($checkStr,','); $sql = "select * from xcatentry where PARTNUMBER in (".$checkStr.")"; $query = $db2->query($sql); while($row = $db2->fetch_array($query)) { foreach($row as $key=>$val) { $row[$key] = iconv('gb2312','utf-8',$val); } $dataAry[$row['PARTNUMBER']]['sysCheckStatus'] = 1; $dataAry[$row['PARTNUMBER']]['basicInfo'] = $row; } include template();