<?php
 error_reporting(E_ALL); ini_set('display_errors', TRUE); ini_set('display_startup_errors', TRUE); date_default_timezone_set('Europe/London'); define('EOL',(PHP_SAPI == 'cli') ? PHP_EOL : '<br />'); date_default_timezone_set('Europe/London'); require_once dirname(__FILE__) . '/../Classes/PHPExcel.php'; $objPHPExcel = new PHPExcel(); $objWorksheet = $objPHPExcel->getActiveSheet(); $objWorksheet->fromArray( array( array('', '', 'Budget', 'Forecast', 'Actual'), array('2010', 'Q1', 47, 44, 43 ), array('', 'Q2', 56, 53, 50 ), array('', 'Q3', 52, 46, 45 ), array('', 'Q4', 45, 40, 40 ), array('2011', 'Q1', 51, 42, 46 ), array('', 'Q2', 53, 58, 56 ), array('', 'Q3', 64, 66, 69 ), array('', 'Q4', 54, 55, 56 ), array('2012', 'Q1', 49, 52, 58 ), array('', 'Q2', 68, 73, 86 ), array('', 'Q3', 72, 78, 0 ), array('', 'Q4', 50, 60, 0 ), ) ); $dataseriesLabels = array( new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$C$1', NULL, 1), new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$D$1', NULL, 1), new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$E$1', NULL, 1), ); $xAxisTickValues = array( new PHPExcel_Chart_DataSeriesValues('String', 'Worksheet!$A$2:$B$13', NULL, 12), ); $dataSeriesValues = array( new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$C$2:$C$13', NULL, 12), new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$D$2:$D$13', NULL, 12), new PHPExcel_Chart_DataSeriesValues('Number', 'Worksheet!$E$2:$E$13', NULL, 12), ); $series = new PHPExcel_Chart_DataSeries( PHPExcel_Chart_DataSeries::TYPE_BARCHART, PHPExcel_Chart_DataSeries::GROUPING_CLUSTERED, range(0, count($dataSeriesValues)-1), $dataseriesLabels, $xAxisTickValues, $dataSeriesValues ); $series->setPlotDirection(PHPExcel_Chart_DataSeries::DIRECTION_COL); $plotarea = new PHPExcel_Chart_PlotArea(NULL, array($series)); $legend = new PHPExcel_Chart_Legend(PHPExcel_Chart_Legend::POSITION_BOTTOM, NULL, false); $title = new PHPExcel_Chart_Title('Test Grouped Column Chart'); $xAxisLabel = new PHPExcel_Chart_Title('Financial Period'); $yAxisLabel = new PHPExcel_Chart_Title('Value ($k)'); $chart = new PHPExcel_Chart( 'chart1', $title, $legend, $plotarea, true, 0, $xAxisLabel, $yAxisLabel ); $chart->setTopLeftPosition('G2'); $chart->setBottomRightPosition('P20'); $objWorksheet->addChart($chart); echo date('H:i:s') , " Write to Excel2007 format" , EOL; $objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007'); $objWriter->setIncludeCharts(TRUE); $objWriter->save(str_replace('.php', '.xlsx', __FILE__)); echo date('H:i:s') , " File written to " , str_replace('.php', '.xlsx', pathinfo(__FILE__, PATHINFO_BASENAME)) , EOL; echo date('H:i:s') , " Peak memory usage: " , (memory_get_peak_usage(true) / 1024 / 1024) , " MB" , EOL; echo date('H:i:s') , " Done writing file" , EOL; echo 'File has been created in ' , getcwd() , EOL; 