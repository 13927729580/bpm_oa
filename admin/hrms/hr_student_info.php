<?php
 define('IN_DAEM', true); require_once '../includes/init.php'; if ($_GET['submit']) { $name = !empty($_GET['name']) ? trim($_GET['name']) : ''; $sex = !empty($_GET['sex']) ? $_GET['sex'] : ''; $grade = !empty($_GET['grade']) ? $_GET['grade'] : ''; $status = !empty($_GET['status']) ? $_GET['status'] : ''; $cond = ''; if (!empty($name)) { $cond .= " and name like '%".$name."%'"; } if (!empty($sex) && $sex!='0') { $cond .= " and sex = '".$sex."'"; } if (!empty($grade) && $grade!='0') { $cond .= " and grade = '".$grade."'"; } if (!empty($status) && $status!='0') { $cond .= " and status = '".$status."'"; } } $sql = "select * from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where 1=1 ".$cond." order by status desc,grade desc,school"; $query = $db->query($sql); $dataAry = array(); while ($row = $db->fetch_array($query)) { $dataAry[] = $row; } $sql = "select count(*) as totalNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student"; $result = $db->query_first($sql); $totalNum = $result['totalNum']; $sql = "select count(*) as studentNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where status = 'y'"; $result = $db->query_first($sql); $studentNum = $result['studentNum']; $lostNum = $totalNum - $studentNum; $sql = "select count(*) as primaryTotalNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where grade > 0 and grade <= 6"; $result = $db->query_first($sql); $primaryTotalNum = $result['primaryTotalNum']; $sql = "select count(*) as primaryStudentNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where status = 'y' and grade > 0 and grade <= 6"; $result = $db->query_first($sql); $primaryStudentNum = $result['primaryStudentNum']; $primaryLostNum = $primaryTotalNum - $primaryStudentNum; $sql = "select count(*) as middleTotalNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where grade > 6 and grade <= 9"; $result = $db->query_first($sql); $middleTotalNum = $result['middleTotalNum']; $sql = "select count(*) as middleStudentNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where status = 'y' and grade > 6 and grade <= 9"; $result = $db->query_first($sql); $middleStudentNum = $result['middleStudentNum']; $middleLostNum = $middleTotalNum - $middleStudentNum; $sql = "select count(*) as seniorTotalNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where grade > 9 and grade <= 12"; $result = $db->query_first($sql); $seniorTotalNum = $result['seniorTotalNum']; $sql = "select count(*) as seniorStudentNum from ".DB_DAEMDB.".".TB_SUFFIX."hr_student where status = 'y' and grade > 9 and grade <= 12"; $result = $db->query_first($sql); $seniorStudentNum = $result['seniorStudentNum']; $seniorLostNum = $seniorTotalNum - $seniorStudentNum; include template(); 