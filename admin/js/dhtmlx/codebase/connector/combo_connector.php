<?php
 require_once("base_connector.php"); class ComboDataItem extends DataItem{ private $selected; function __construct($data,$config,$index){ parent::__construct($data,$config,$index); $this->selected=false; } function select(){ $this->selected=true; } function to_xml_start(){ if ($this->skip) return ""; return "<option ".($this->selected?"selected='true'":"")."value='".$this->get_id()."'><![CDATA[".$this->data[$this->config->text[0]["name"]]."]]>"; } function to_xml_end(){ if ($this->skip) return ""; return "</option>"; } } class ComboConnector extends Connector{ private $filter; private $position; public function __construct($res,$type=false,$item_type=false,$data_type=false){ if (!$item_type) $item_type="ComboDataItem"; parent::__construct($res,$type,$item_type,$data_type); } function parse_request(){ parent::parse_request(); if (isset($_GET["pos"])){ if (!$this->dload) LogMaster::log("Dyn loading request received, but server side was not configured to process dyn. loading. "); else $this->request->set_limit($_GET["pos"],$this->dload); } if (isset($_GET["mask"])) $this->request->set_filter($this->config->text[0]["db_name"],$_GET["mask"]."%","LIKE"); LogMaster::log($this->request); } public function xml_start(){ if ($this->request->get_start()) return "<complete add='true'>"; else return "<complete>"; } public function xml_end(){ return "</complete>"; } } ?>