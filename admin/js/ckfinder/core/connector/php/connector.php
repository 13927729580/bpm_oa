<?php
 ob_start(); require_once dirname(__FILE__) . '/constants.php'; require_once CKFINDER_CONNECTOR_LIB_DIR . '/CommandHandler/CommandHandlerBase.php'; require_once CKFINDER_CONNECTOR_LIB_DIR . '/Core/Factory.php'; require_once CKFINDER_CONNECTOR_LIB_DIR . '/Utils/Misc.php'; require_once CKFINDER_CONNECTOR_LIB_DIR . '/Core/Hooks.php'; function resolveUrl($baseUrl) { $fileSystem =& CKFinder_Connector_Core_Factory::getInstance("Utils_FileSystem"); $baseUrl = preg_replace("|^http(s)?://[^/]+|i", "", $baseUrl); return $fileSystem->getDocumentRootPath() . $baseUrl; } $utilsSecurity =& CKFinder_Connector_Core_Factory::getInstance("Utils_Security"); $utilsSecurity->getRidOfMagicQuotes(); $config = array(); $config['Hooks'] = array(); $config['Plugins'] = array(); if (!empty($_GET['command']) && $_GET['command'] == 'FileUpload' && !empty($_POST)) { foreach ($_POST as $key => $val) { if (strpos($key, "ckfcookie_") === 0) $_COOKIE[str_replace("ckfcookie_", "", $key)] = $val; } } require_once CKFINDER_CONNECTOR_CONFIG_FILE_PATH; CKFinder_Connector_Core_Factory::initFactory(); $connector =& CKFinder_Connector_Core_Factory::getInstance("Core_Connector"); if(isset($_GET['command'])) { $connector->executeCommand($_GET['command']); } else { $connector->handleInvalidCommand(); } 