<?php
 define('IN_DAEM', true); include '../includes/init.php'; require_once '../includes/excel/Classes/PHPExcel.php'; require_once "./excelBIConfig.php"; if($_GET["act"]=="downloadTemplate" && !empty($_GET["templateSign"])) { $templateDataAry = array(); $sql = "select * from excel_template_struct where sign = '".$_GET["templateSign"]."'" ; $result = $db->query_first($sql); $dataAry = json_decode($result["template_struct"],true); foreach($dataAry as $key=>$val) { foreach($val as $k=>$v) { $dataAry[$key][$k]["name"] = base64_decode($dataAry[$key][$k]["name"]); $dataAry[$key][$k]["value"] = base64_decode($dataAry[$key][$k]["value"]); } } header("Content-type:application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"); header("Content-Disposition:filename=".$result['name']."批量导入模板.xlsx"); foreach($dataAry as $key=>$val) { foreach($val as $k=>$v) { $isNeed = ($v["isNeed"] == '1') ? '*' : ''; if($v["type"]!="title") { $v["name"] = iconv("utf-8","GBK",$v["name"]); echo $v["name"].$isNeed."\t"; } } } }