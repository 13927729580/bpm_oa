<?php
 define('IN_DAEM', true); include '../includes/init.php'; set_time_limit(0); $userAry = get_user_realname(); $userName = $_SESSION['UserName']; $editor = $userName; $filePath = '../../data/upload/question_bank/qst_img_201406/'; $filesNameAry = scandir($filePath); $questionImgAry = array(); $sql = "select question_img_path,a_option_img_path,b_option_img_path,c_option_img_path,d_option_img_path 
		from ".DB_DAEMDB.".".TB_SUFFIX."qb_question_info order by create_time desc limit 50"; $query = $db->query($sql); while ($row = $db->fetch_array($query)) { $question_img_path = trim($row['question_img_path']); if (!empty($question_img_path)) { $imgFilename = str_replace($filePath, '', $question_img_path); $questionImgAry[$imgFilename] = $question_img_path; } $a_option_img_path = trim($row['a_option_img_path']); if (!empty($a_option_img_path)) { $imgFilename = str_replace($filePath, '', $a_option_img_path); $questionImgAry[$imgFilename] = $a_option_img_path; } $b_option_img_path = trim($row['b_option_img_path']); if (!empty($b_option_img_path)) { $imgFilename = str_replace($filePath, '', $b_option_img_path); $questionImgAry[$imgFilename] = $b_option_img_path; } $c_option_img_path = trim($row['c_option_img_path']); if (!empty($c_option_img_path)) { $imgFilename = str_replace($filePath, '', $c_option_img_path); $questionImgAry[$imgFilename] = $c_option_img_path; } $d_option_img_path = trim($row['d_option_img_path']); if (!empty($d_option_img_path)) { $imgFilename = str_replace($filePath, '', $d_option_img_path); $questionImgAry[$imgFilename] = $d_option_img_path; } } $redundantImgPathAry = array(); foreach ($filesNameAry as $key=>$val) { if (!isset($questionImgAry[$val])) { $redundantImgPathAry[] = $val; } } print_r($questionImgAry);die; 